\chapter{Summary, conclusions, \& outlook}
\vspace*{3mm}
In this chapter, we reflect on all that we have learnt from the preceding investigations, what more could be gained from it and where we should proceed with caution. 
\section{Summary}
Taking an eagle-eye's view, we have a desire to better understand and model turbulent transport in plasmas, which is hindered by the complex nonlinear nature of the phenomena involved. A method we employ to tackle this problem is, both philosophically and methodologically speaking, a thermodynamic approach. That is, we make no attempt to describe the precise temporal evolution of the plasma and its constituents, and instead focus on a perspective of energetics and constraints on the system as a whole. This allows one to derive various quantities of interest, such as bounds on nonlinear growth rates of energy \cite{helander2022energetic,plunk2022energetic,plunk2023energetic} or bounds on how much thermal energy can be extracted from the plasma distribution function \cite{gardner1963bound,helander2017available,kolmes2020recovering,helander2020available}, and this thesis focusses on the latter. \par 
This upper bound, called the available energy (\AE{}), depends critically on the constraints imposed on the system. Different constraints result in different answers, and as such, an applicable choice of the constraints is crucial. One especially promising choice of constraints is to impose that the distribution function obeys Liouville's theorem, invariance of the electron magnetic moment, and invariance of $\mathcal{J}$ (often called the second invariant or the parallel invariant). Previous investigations revealed that imposing such constraints aligned with results from the gyrokinetic results of the trapped electron mode, a mode of importance in experiments in both tokamaks and stellarators \cite{rewoldt2005comparison,guttenfelder2008effect,fable2009role}. This makes it a natural candidate to connect the fields of available energy and plasma turbulence, and here we find the inception of the work of this thesis. \par 
In order to accurately calculate the \AE{}, our first course of action was to find precise methods of calculating the various quantities on which \AE{} depends, for which we have constructed a code. These are so-called bounce averages of various functions, for which we construct a numerical framework and create a number of benchmarks by deriving analytical expressions and comparing them against numerical calculations. The framework and benchmarks allow us to assess the performance of various numerical routines, both in terms of accuracy and speed. We found that a straightforward generalisation of the trapezoidal method to calculate the integrals required for such bounce-averages can outperform (in terms of speed) more conventional methods such as quadrature. The code that calculates bounce averages is the basis for the calculations of \AE{}. \par 
We then turned our attention to the problem at hand: finding connections between \AE{} and gyrokinetic turbulence. To ensure that \AE{} models the situation adequately, we first generalised previous results to account for trapped particles that drift radially, so that \AE{} may be calculated in any equilibrium, and found that such radial drifts can significantly affect \AE{} especially if the gradients are small. The generalised \AE{} allowed us to calculate and compare the \AE{} of several stellarator and tokamak equilibria (the DIII-D tokamak, the Helically Symmetric eXperiment, and W7-X) for which nonlinear gyrokinetic turbulence simulations had been performed. There was one important caveat as one had to set a length scale over which energy was available. We argued that this is similar to the length scale over which gradients are flattened; the correlation length. This correlation length is on the order of the gyroradius for micro turbulence, and we thus chose this length scale to be proportional to the gyroradius. Using a simple model for the proportionality factor, namely a constant, we go on to compare the \AE{} with the nonlinear heat flux and found a correlation between the two for trapped-electron-mode dominated electrostatic turbulence simulations, culminating in a power law. This power law could, through a crude argument, be motivated, providing insight into this connection between \AE{} and turbulence. We then turned our attention to the spatial structure of \AE{}, for which we investigated the dependence of \AE{} on the considered bounce well. This allowed us to pin-point which regions of the bounce-well contributed most to the instability of the TEM, and we found that it was typically the deeply trapped particles and regions with trapped particles which drift radially. Therefore, an optimal stellarator (in terms of \AE{}) should have radially stationary trapped particles and be maximum-$\mathcal{J}$ for as many trapped particles as possible. Finally, we investigate the asymptotic behaviour of \AE{} in terms of gradient strength. Here, we identified two distinct regions with different scalings. For weak gradients, we found a sharp decrease in \AE{} with decreasing gradient strength, whereas in a strongly driven regime \AE{} responds linearly to the gradient strength, somewhat reminiscent of gradient threshold-type behaviour. \par
Since the \AE{} showed a connection to turbulent transport, we considered simplified scenarios in which the dependence of \AE{} on various parameters of interest can be investigated. To this end, we specialised the theory in tokamak equilibria, which simplified some of the steps required in the calculation of \AE{}. Furthermore, we specialised the tokamak geometry in a family of equilibria considered by \citet{miller1998noncircular}, which depend on magnetic shear, pressure gradient, and triangularity. The dependence of \AE{} on this set of parameters could then be deduced. We found that negative shear and a high pressure gradient help reduce \AE{}. The dependence on triangularity was found to be more involved, reducing \AE{} only when shear was sufficiently high or when the gradient was sufficiently low. We then estimated a gradient threshold-like quantity from \AE{} and found that this threshold increased with increasing magnetic shear and decreasing triangularity. Next, we optimised the tokamak geometry (i.e. elongation and triangularity) to minimise \AE{} and found that such an optimal geometry is strongly dependent on equilibrium parameters such as magnetic shear and pressure gradient. Going on to consider more experimentally relevant dependencies, we investigated the dependencies of \AE{} on the density gradient, the pressure gradient, and the magnetic shear simultaneously, which are generally coupled via, e.g., bootstrap currents. This allowed us to identify paths in the three-dimensional parameter space of shear, pressure gradient, and density gradient, in which one could increase the density gradient while {\it lowering} the \AE{}. These paths generally required that, as the density gradient increases, the pressure gradient should increase, and the shear should decrease, and we argued that such dependencies are found in experiments. The qualitative difference of the path was strongly dependent on the geometry considered, with the negative triangularity geometry not showing a sharp decrease in \AE{} with increasing density gradient. We finally made an additional comparison with the nonlinear heat flux by means of the \textsc{tglf}-code. This showed a correspondence between the \AE{} and the estimated heat flux, with regions in parameter space where the correspondence is less pronounced. These deviations can be corrected for by improving the model for the proportionality factor in the available energy length scale.  \par 

\section{Conclusions}
With all the results of the publications reiterated, let us return to the central question put forth in the thesis, {\it can \AE{} predict gyrokinetic turbulent transport and can it be used to infer its dependencies?} With the important caveat that we can only make statements on this premise when it concerns trapped electrons, we may now attempt to formulate an answer. \par 
For these trapped electrons, we have found that there is a connection between \AE{} and turbulence, as made clear by the correlation between the heat flux and \AE{}. The correlation found shows that \AE{} is useful as a turbulence measure. By specialising the research to tokamaks, we were able to investigate dependencies on parameters like magnetic shear, pressure gradient, and elongation, which allowed us to compare with the existing literature. This showed a correspondence, for example, with negative shear or large pressure gradients having a decreased \AE{} compared to those with little shear or pressure gradient. We should, however, proceed with caution and stress under what conditions one could expect deviations from the found power law. 
\begin{enumerate}
    \item Returning to the definition of \AE{}, we recall that it represents the maximal amount of thermal energy that may be liberated, and thus provides an upper bound for the turbulent energy. However, the true turbulent state is a dynamic one, and as such {\it cannot} be the stationary ground state. The question then is how dissimilar the dynamic state is from the ground state. The similarities highlighted of turbulence and \AE{} in various publications show that there is similarity, but it is not inconceivable that there are situations in which the dynamic state is very distinct from the ground state. 
    \item Similarly to the previous point, we remind ourselves that there are several stabilising mechanisms present in plasma turbulence, the prototypical example being the zonal flow \cite{diamond2005zonal,itoh2006physics,fujisawa2008review}. Zonal flows are large radial variations in the electrostatic potential, which via $\boldsymbol{E}\times \boldsymbol{B}$ flows stabilise the turbulence. Note that this zonal flow is formed by part of the \AE{} (i.e. it has some energy associated with it), yet it acts {\it stabilising}. More mechanisms have been identified, e.g. perpendicular particle diffusion as shown by \citet{merz2008nonlinear}, and others can be found in Refs. \cite{terry2015overview,pueschel2016stellarator,hegna2018theory,faber2018stellarator}. In a zonal-flow-dominated scenario a na\"ive heat-flux estimate from \AE{} may falter as much of the energy resides in the electric field generating the zonal flow. More broadly speaking, \AE{} is a theory that estimates how much energy is liberated, but it does not account for how the energy is {\it distributed}. 
    \item \AE{} has one free parameter that one cannot set a priori, namely the length scale over which energy is available. We have argued that this should be similar to the perpendicular correlation length, and in general this length scale can depend on equilibrium parameters and may vary. The problem is even more fundamental, as we have only argued that it is similar to the correlation length, but not that it is necessarily the same. As such, finding the correct length scale is an ill-defined question, which, depending on its definition, may have different answers. One attractive option is to define the correlation length to be the length scale that minimises the error between the heat flux and the \AE{} estimate. The length-scale would then play a similar role as the quasilinear weights in codes which estimates heat- and particle fluxes using linear estimates (e.g. QuaLiKiz or {\sc tglf}) \cite{staebler2007theory,casati2009validating,citrin2012quasilinear,staebler2021verification}.
\end{enumerate}
To return to the central question of the thesis, we state that the \AE{} of trapped electrons can predict gyrokinetic turbulence and its dependencies, with some important caveats (stressed above) that one should keep in mind. This is shown by several observations; there is a correlation between \AE{} and heat flux, and \AE{} reproduces known trends in tokamaks. It furthermore exhibits more behaviours similar to turbulence, such as gradient-threshold-like behaviours and unfavorable scalings (i.e. increasing \AE{}) with a lesser degree of omnigeneity.

\section{Outlook}
The research question is now answered, and we look forward to what research can be pursued next. We present this as a list, with the most low-hanging fruit listed first and more exotic research projects presented later.
\begin{enumerate}
    \item {\it Stellarator optimisation:} the most straightforward application of the found results is stellarator optimisation, where one attempts to find the best performing (low turbulent energy losses, good fast particle confinement) stellarator. Previously, evaluating turbulence was impossible due to the high computational cost of such simulations, but with \AE{} it is now practicable. This is attractive for several reasons; the \AE{} penalises lack of radially stationary trapped particles which is a common goal of stellarator optimisation, and the optimisation will try to find maximum-$\mathcal{J}$ configurations (at least for density gradient driven trapped-electron-modes) which has also become a more common goal in optimisation. The attractive property of \AE{} is that it penalises both in a consistent fashion, and it also accounts for different trapped particles (as parameterised by $\lambda$). \AE{} however does not, in its current form, also consistently weigh different flux surfaces, and as such one needs to account for this in some manner (one possible method of doing so may be found in \citet{goodman2022constructing}). We have, of course, seen an attempt at optimisation in a simplified scenario in the investigation into tokamaks, where several important conclusions were drawn; the optimisation depends critically on the various profiles of temperature, density, pressure, and rotational transform. Ultimately, all of these should be calculated self-consistently (such as in the \textsc{trinity}-code \cite{barnes2009trinity,barnes2010direct,highcock2014trinity,highcock2018optimisation}) so that the profiles themselves become part of the optimisation routine.
    \item {\it Further validation:} In the presented investigation we have made various predictions which can be scrutinised to a greater degree. For example, we have seen that at high shear, negative triangularity becomes favourable and should benefit from a reduction in transport, in line with some research. This claim may be tested by means of a gyrokinetic code to investigate if this claim is indeed true in general or, if it falters, to find under what conditions the claim fails. This is also true for claims relating to gradient threshold behaviour: various predictions have been made in terms of how the \AE{}-estimate of this threshold moves, and we have made a connection to past research. The gold standard is a comparison against gyrokinetic codes, an endeavour which should be undertaken.
    \item {\it Generalisation to multispecies plasmas:} Seeing the successful description of the \AE{} of trapped electrons, it is natural to wonder about extensions of the research to account for ions and perhaps even impurities. As stressed multiple times in the thesis, such a generalisation depends critically on the chosen invariants, and these choices non-trivially alter the \AE{}. Appropriate choices are not obvious a priori. If a set of invariants is successfully found, the domain of application of \AE{} can be expanded to account for ion species and passing electron species, too. 
    \item {\it Applications outside of plasma physics:} Although the entire thesis has focused on plasma physics, none of the methodologies presented restricts it to this domain: the first application of \AE{} in physics was meteorology after all \cite{lorenz1955available}. In essence, the only requirement for the methods presented is Liouville's theorem, which many systems obey. A list of such systems is given in the references of \cite{kolmes2020available,mackenbach2022available}, but let us highlight a few of these systems here. One famous example is the Vlasov-Poisson system underlying the dynamics of collisionless self-gravitating matter, in which the potential of the Vlasov-Poisson system is the gravitational potential. In quantum physics, there is a correspondence between Bose-Einstein condensates and Vlasov-Poisson systems, as shown by \citet{mocz2018schrodinger}, and the \AE{} can thus be applied to such systems, too. The framework can hence be extended to these systems, and the problem becomes more interesting by imposing additional invariants.
\end{enumerate}
These possibilities allude to many more fruitful applications of the research presented, but, as always, the proof of the pudding is in the eating. \par 
Let us finally take a step back and place the research in a bigger picture. This research falls into the broader scope of plasma thermodynamics, and this field is blossoming, with many promising results found in the last couple of years \cite{helander2017available,helander2020available,kolmes2020recovering,helander2022energetic,plunk2022energetic,kolmes2022minimum,ewart2022collisionless,plunk2023energetic,ewart2023non}. This is in contrast to more traditional methods, where one investigates the dynamics of plasma systems by researching the (linearised) equations and extracting quantities such as growth rates. This traditional approach approach is, of course, valuable, especially with new advances in machine learning that speed up calculations \cite{hui2021machine,mathews2021turbulent,kube2021machine,ho2021neural,anirudh20222022}. Plasma thermodynamics may then be considered a less-explored complementary approach, where one neglects detailed descriptions of dynamics in favour of bounds. It is here that we may find general insights about fundamental processes in plasmas, and I look forward to seeing the field mature.